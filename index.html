<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Flickr Moving Rows Slideshow</title>
  <style>
    body {
      margin: 0;
      background: black;
      overflow: hidden;
    }
    .slideshow {
      display: flex;
      flex-direction: column;
      height: 100vh;
      width: 100vw;
    }
    .row {
      display: flex;
      white-space: nowrap;
      overflow: hidden;
      flex: 1; /* evenly divide space */
    }
    .row img {
      height: 100%;
      margin-right: 10px;
      border-radius: 8px;
      object-fit: cover;
    }
  </style>
</head>
<body>
  <div class="slideshow" id="slideshow"></div>

  <script>
    const slideshow = document.getElementById("slideshow");
    const API_KEY = "4855498d62dbadaf2bd11df6fcdb9f08";
    const USERNAME = "sulamitachurchpdx";
    const ROW_COUNT = 6; // number of moving rows

    // Get Flickr user_id from username
    async function getUserId(username) {
      const url = `https://www.flickr.com/services/rest/?method=flickr.people.findByUsername&api_key=${API_KEY}&username=${username}&format=json&nojsoncallback=1`;
      const res = await fetch(url);
      const data = await res.json();
      return data.user.nsid;
    }

    // Fetch photos from Flickr
    async function fetchPhotos(userId) {
      const url = `https://www.flickr.com/services/rest/?method=flickr.people.getPublicPhotos&api_key=${API_KEY}&user_id=${userId}&per_page=200&format=json&nojsoncallback=1`;
      const res = await fetch(url);
      const data = await res.json();
      return data.photos.photo.map(p =>
        `https://live.staticflickr.com/${p.server}/${p.id}_${p.secret}_b.jpg`
      );
    }

    // Build rows
    function buildRows(images) {
      for (let i = 0; i < ROW_COUNT; i++) {
        const row = document.createElement("div");
        row.className = "row";
        row.dataset.speed = (i % 2 === 0 ? 1 : -1); // alternate direction

        // duplicate images so scrolling loops seamlessly
        for (let k = 0; k < 2; k++) {
          images.forEach(url => {
            const img = document.createElement("img");
            img.src = url;
            row.appendChild(img);
          });
        }

        slideshow.appendChild(row);
      }
    }

    // Animate scrolling
    function animate() {
      const rows = document.querySelectorAll(".row");
      const speed = 0.5; // movement speed
      rows.forEach(row => {
        let dir = parseFloat(row.dataset.speed);
        row.scrollLeft += speed * dir;
        if (row.scrollLeft >= row.scrollWidth - row.clientWidth) {
          row.scrollLeft = 0;
        } else if (row.scrollLeft <= 0) {
          row.scrollLeft = row.scrollWidth;
        }
      });
      requestAnimationFrame(animate);
    }

    // Init
    (async function init() {
      const userId = await getUserId(USERNAME);
      const photos = await fetchPhotos(userId);
      buildRows(photos);
      animate();
    })();
  </script>
</body>
</html>
